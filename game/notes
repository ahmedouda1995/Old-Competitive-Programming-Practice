Decision tree + memoization + period detection

Move duplication strategy

